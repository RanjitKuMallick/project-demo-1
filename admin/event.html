<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin – Manage Events</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .card-preview img {
      height: 200px;
      object-fit: cover;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold">Admin – Manage Events</h2>
      <button id="logoutBtn" class="btn btn-outline-danger btn-sm">Logout</button>
    </div>

    <div id="alertBox"></div>

    <!-- Event Form -->
    <form id="eventForm" class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Event Title</label>
        <input type="text" id="title" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">Date</label>
        <input type="date" id="date" class="form-control" required>
      </div>
      <div class="col-md-12">
        <label class="form-label">Description</label>
        <textarea id="desc" rows="2" class="form-control"></textarea>
      </div>
      <div class="col-md-6">
        <label class="form-label">Image URL</label>
        <input type="url" id="image" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="form-label">Badge Text</label>
        <input type="text" id="badge" class="form-control">
      </div>
      <div class="col-md-2">
        <label class="form-label">Badge Color</label>
        <select id="badgeColor" class="form-select">
          <option value="warning">Warning</option>
          <option value="danger">Danger</option>
          <option value="success">Success</option>
          <option value="dark">Dark</option>
        </select>
      </div>
      <div class="col-md-1">
        <label class="form-label">Icon</label>
        <input type="text" id="icon" class="form-control" placeholder="fa-star">
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-primary">Add Event</button>
      </div>
    </form>

    <!-- Preview -->
    <h4 class="mt-5">Live Preview</h4>
    <div class="card mt-3 shadow-sm card-preview">
      <div class="position-relative">
        <img id="previewImage" src="" class="card-img-top" alt="Preview">
        <span id="previewBadge" class="badge position-absolute top-0 start-0 m-2 px-3 py-2 fs-6 shadow-sm" style="border-radius:0 10px 10px 0;">Badge</span>
        <span id="previewDate" class="position-absolute bottom-0 end-0 m-2 bg-dark text-white px-2 py-1 rounded-pill small opacity-75">Date</span>
      </div>
      <div class="card-body">
        <h5 class="card-title fw-bold" id="previewTitle">Title</h5>
        <p class="card-text" id="previewDesc">Description</p>
      </div>
    </div>

    <!-- Saved Events -->
    <h4 class="mt-5">Saved Events</h4>
    <div id="eventList" class="row row-cols-1 row-cols-md-2 g-4 mt-2"></div>
  </div>

  <script>


    // Form Inputs
    const title = document.getElementById("title");
    const date = document.getElementById("date");
    const desc = document.getElementById("desc");
    const image = document.getElementById("image");
    const badge = document.getElementById("badge");
    const badgeColor = document.getElementById("badgeColor");
    const icon = document.getElementById("icon");

    // Preview Elements
    const previewTitle = document.getElementById("previewTitle");
    const previewDesc = document.getElementById("previewDesc");
    const previewDate = document.getElementById("previewDate");
    const previewImage = document.getElementById("previewImage");
    const previewBadge = document.getElementById("previewBadge");

    // Live Preview
    [title, desc, date, image, badge, badgeColor, icon].forEach(input => {
      input.addEventListener("input", updatePreview);
    });

    function updatePreview() {
      previewTitle.innerText = title.value;
      previewDesc.innerText = desc.value;
      previewDate.innerText = date.value;
      previewImage.src = image.value;
      previewBadge.innerHTML = `<i class='fas ${icon.value} me-1'></i>${badge.value}`;
      previewBadge.className = `badge bg-${badgeColor.value} position-absolute top-0 start-0 m-2 px-3 py-2 fs-6 shadow-sm`;
    }

    // Add Event
    document.getElementById("eventForm").addEventListener("submit", function(e) {
      e.preventDefault();
      if (!title.value || !date.value || !image.value) {
        return showAlert("Please fill in all required fields.", "danger");
      }
      const newEvent = {
        title: title.value,
        desc: desc.value,
        date: date.value,
        image: image.value,
        badge: badge.value,
        badgeColor: badgeColor.value,
        icon: icon.value
      };
      const events = JSON.parse(localStorage.getItem("events") || "[]");
      events.push(newEvent);
      localStorage.setItem("events", JSON.stringify(events));
      showAlert("Event added successfully!", "success");
      displayEvents();
      this.reset();
      updatePreview();
    });

    // Show Events
    function displayEvents() {
      const list = document.getElementById("eventList");
      const events = JSON.parse(localStorage.getItem("events") || "[]");
      list.innerHTML = events.map((ev, i) => `
        <div class="col">
          <div class="card h-100">
            <img src="${ev.image}" class="card-img-top" style="height:180px;object-fit:cover">
            <div class="card-body">
              <h5 class="card-title">${ev.title}</h5>
              <p class="card-text">${ev.desc}</p>
              <span class="badge bg-${ev.badgeColor}"><i class="fas ${ev.icon} me-1"></i>${ev.badge}</span>
              <p class="text-muted small mt-2">${ev.date}</p>
              <button class="btn btn-sm btn-danger mt-2" onclick="deleteEvent(${i})">Delete</button>
            </div>
          </div>
        </div>`).join("");
    }

    function deleteEvent(index) {
      const events = JSON.parse(localStorage.getItem("events") || "[]");
      events.splice(index, 1);
      localStorage.setItem("events", JSON.stringify(events));
      showAlert("Event deleted.", "warning");
      displayEvents();
    }

    function showAlert(message, type) {
      const alertBox = document.getElementById("alertBox");
      alertBox.innerHTML = `<div class='alert alert-${type} alert-dismissible fade show' role='alert'>
        ${message}
        <button type='button' class='btn-close' data-bs-dismiss='alert'></button>
      </div>`;
    }

    // Initial load
    displayEvents();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
